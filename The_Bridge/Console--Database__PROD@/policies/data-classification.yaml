# Data Classification Policy
# Defines sensitivity levels and handling requirements

classification_levels:
  green:
    name: "Public"
    description: "Non-sensitive data that can be freely shared"
    encryption_required: false
    audit_required: false
    retention_days: null
    examples:
      - "Reference data (DEFRA factors, HS codes)"
      - "Public company information"
      - "Published ESG metrics"
    
  amber:
    name: "Internal"
    description: "Internal business data requiring basic protection"
    encryption_required: false
    audit_required: true
    retention_days: 2555  # 7 years
    examples:
      - "Shipment routes and schedules"
      - "Aggregated emissions data"
      - "Agent run traces"
      - "Business metrics"
    
  red:
    name: "Confidential"
    description: "Sensitive business data requiring strong protection"
    encryption_required: true
    audit_required: true
    retention_days: 2555  # 7 years
    access_control: "role-based"
    examples:
      - "Customer contracts"
      - "Pricing information"
      - "Detailed financial data"
      - "Strategic plans"
      - "API keys (hashed)"
    
  black:
    name: "Restricted"
    description: "Highly sensitive data with strict access controls"
    encryption_required: true
    audit_required: true
    retention_days: 3650  # 10 years
    access_control: "need-to-know"
    pii_handling: true
    examples:
      - "Personal Identifiable Information (PII)"
      - "Payment card data"
      - "Authentication credentials"
      - "Encryption keys"

table_classifications:
  # Bridge schema
  bridge.tenants: amber
  bridge.projects: amber
  bridge.service_accounts: red
  bridge.contracts: green
  bridge.event_registry: amber
  bridge.agents: amber
  bridge.lineage: amber
  bridge.policies: amber

  # Core schema
  core.org: amber
  core.document: amber
  core.esg_metric: amber
  core.batch: amber
  core.shipment: amber
  core.emissions_event: amber
  core.partner_opportunity: amber
  
  # Memory schema
  core.memory_kv: amber
  core.memory_doc: amber
  core.agent_run: amber
  core.memory_conversation: amber
  core.memory_insight: amber
  core.memory_tool: green
  core.memory_tool_usage: amber

  # Reference schema (all green/public)
  reference.defra_factors_v2025: green
  reference.icao_airports: green
  reference.hs_codes: green
  reference.countries: green
  reference.exchange_rates: green
  reference.transport_routes: green
  reference.commodity_emissions: green

  # PII schema (if created)
  pii.persons: black
  pii.contacts: black
  pii.identifiers: black

column_classifications:
  # Specific sensitive columns
  bridge.service_accounts.api_key_hash: red
  core.org.tax_id: red
  core.document.content_hash: amber
  core.memory_kv.value: amber  # May contain secrets
  
handling_rules:
  green:
    - "Can be stored in plain text"
    - "Can be transmitted over HTTP (though HTTPS preferred)"
    - "Can be included in logs"
    - "No special disposal requirements"
  
  amber:
    - "Must use TLS for transmission"
    - "Should not be logged in full"
    - "Requires authentication for access"
    - "Soft delete with retention period"
  
  red:
    - "Must be encrypted at rest"
    - "Must use TLS 1.2+ for transmission"
    - "Must not be logged"
    - "Requires authorization + audit trail"
    - "Secure deletion required"
  
  black:
    - "Must use AES-256 encryption at rest"
    - "Must use mTLS for transmission"
    - "Must never be logged or cached"
    - "Requires MFA + approval workflow"
    - "Crypto-shredding for disposal"
    - "Regular access reviews required"

compliance_mappings:
  gdpr:
    personal_data: black
    pseudonymized_data: red
    anonymized_data: amber
    
  pci_dss:
    card_data: black
    transaction_data: red
    
  sox:
    financial_records: red
    audit_logs: red
    
  iso27001:
    cryptographic_keys: black
    access_logs: amber
    system_configurations: red

monitoring:
  alerts:
    - trigger: "Access to black classified data"
      action: "Immediate notification to security team"
    - trigger: "Bulk export of red classified data"
      action: "Manager approval required"
    - trigger: "Cross-tenant access attempt"
      action: "Block and alert"
      
  metrics:
    - "Count of black data accesses per day"
    - "Volume of red data transmitted"
    - "Failed access attempts by classification"
    
  audit_retention:
    green: 90  # days
    amber: 365
    red: 2555  # 7 years
    black: 3650  # 10 years